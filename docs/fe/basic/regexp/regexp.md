# 正则表达式

正则表达式 (Regular Expression) 由 2 部分组成：

- 模式 (pattern)
- 修饰符 (flag)

| 修饰符 | 含义               |
| ------ | ------------------ |
| `i`    | 不区分大小写       |
| `g`    | 搜索所有匹配项     |
| `m`    | 多行模式           |
| `s`    | 允许 `.` 匹配 `\n` |
| `u`    | 完整 Unicode 支持  |
| `y`    | 在指定位置搜索     |

创建正则表达式：

- `new RegExp('pattern', 'flags')`
  - 支持动态
- `/pattern/flags`
  - 静态

## 字符类

| 字符类       | 含义                                          |
| ------------ | --------------------------------------------- |
| `\d` (digit) | 数字                                          |
| `\s` (space) | 空白符：空格、`\t`、`\n`、`\v`、`\f`、`\r` 等 |
| `\w` (word)  | “单字”：字母、数字、下划线 `_`                |
| `\D`         | `\d` 反向类，非数字                           |
| `\S`         | `\S` 反向类，非空白符                         |
| `\W`         | `\w` 反向类，非字母、数字、下划线             |
| `.`          | 除 `\n` 外任何字符                            |

## Unicode

`\p{}` 和修饰符 `u` 可以匹配 Unicode 字符。

| 正则 | 全称      | 含义       |
| ---- | --------- | ---------- |
| `L`  | Letter    | 字母       |
| `Ll` | lowercase | 小写       |
| `Lm` | modifier  | 修饰       |
| `Lt` | titlecase | 首字母大写 |
| `Lu` | uppercase | 大写       |
| `Lo` | other     | 其他       |

## anchor

`^` 匹配开头，`$` 匹配结尾。使用修饰符 `m` 后也匹配每一行的开头和结尾。

## 词边界

`\b` 匹配词的边界，一侧匹配 `\w`，一侧不匹配 `\w`。

## 转义

特殊字符 `[ ] { } ( ) \ ^ $ . | ? * +` 使用反斜杠 `\` 进行转义。

正则字面量需要转义 `/`，普通字符串需要转义 `\`。

## 集合和范围

集合 `[xxx]` 表示方括号中字符中的任意一个。

集合中可以包含范围，比如 `[a-z]`、`[A-Z]`、`[0-9]`。

在集合开头加上 `^` 表示除了方括号中字符之外的任意一个字符。

除了集合中有特殊含义的字符，其他特殊字符都不需要转义。

需要转义的字符：

- 开头的 `^`
- 中间的 `-`
- 右方括号 `]`

## 量词

量词表示匹配的字符数量。

- 确切数量：`{n}`
- 数量范围：`{lo, hi}` 闭区间，`hi` 省略表示无限
- 缩写：
  - `?`：`{0,1}`
  - `*`：`{0,}`
  - `+`：`{1,}`

## greedy 和 lazy

量词匹配默认是贪婪的 (greedy)，尽可能多地匹配字符，直到不满足条件再回溯。

在量词后添加问号 `?` 启用惰性量词 (lazy)，比如 `??`、`*?`、`+?`，尽可能少地匹配字符，每次匹配成功后就停下来尝试匹配剩余正则部分。

## 捕获组

用圆括号 `()` 括起来的部分称为捕获组 (capturing group)。

没有 `g` 修饰符的匹配结果数组会包含每个组的匹配结果，按照从左到右、从外到内的顺序编号。

在左括号后紧跟 `?<name>` 为组命名，通过 `res.groups.name` 访问。

如果必须使用组但不希望单独出现匹配结果，可以在开头添加 `?:`。

在正则中使用 `\N` 和 `\k<name>` 引用前面出现的组。

## 或

使用 `|` 表示或。

## lookahead/behind

lookahead (向前/右看)：

- `X(?=Y)`：仅在后面是 `Y` 时匹配 `X`
- `X(?!Y)`：仅在后面不是 `Y` 时匹配 `X`

lookbehind (向后/左看)：

- `(?<=Y)X`：仅在前面是 `Y` 时匹配 `X`
- `(?<!Y)X`：仅在前面不是 `Y` 时匹配 `X`
