# DoS

拒绝服务 (Denial of Service，DoS) 是指通过某种手段使大量服务器资源被快速消耗，从而使服务器无法响应更多请求，造成服务不可用。

## DDoS

分布式拒绝服务 (Distributed DoS，DDoS) 是指大量僵尸设备短时间向服务器发起大量请求，造成服务端**带宽**或 **CPU** 耗尽，无法响应新的请求。常见的有 SYN Flood。

特点：

- 直接访问 IP
- 不区分 API
- 消耗大量带宽

### 防御措施

- 流量治理
  - 负载均衡
  - API 网关
  - CDN
- 快速自动扩容
- 非核心服务降级

## ReDoS (Regex DoS)

不加问号 `?` 的正则表达式拥有**贪婪匹配**的特性，通过构造特定结构的字符串能够造成正则匹配过程中的大量回溯，从而使接口响应时间大幅增加、吞吐量大幅减少。

![](./assets/regex_dos.jpg)

### 防御措施

- Code Review 避免上线此类代码
- 代码扫描 + 正则性能测试
- 不使用用户提供的正则

## Logical DoS

开发者编写的一些不合理的代码或一些不合理的需求，也会导致服务器资源被大量消耗、接口响应时间变长，比如：

- 耗时的同步操作
- 数据库写入
- SQL join
- 文件备份
- 循环执行逻辑
